generator client {
  provider = "prisma-client-js"
  output   = "../../../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Example Models - Customize based on your needs

model User {
  id          String     @id @default(uuid())
  email       String     @unique
  username    String?    @unique
  password    String
  role        Role       @default(USER)
  
  // Profile Info
  firstName   String?    @map("first_name")
  lastName    String?    @map("last_name")
  displayName String?    @map("display_name")
  avatar      String?
  
  // Work Info
  department  String?
  position    String?
  
  // Security & Status
  status      UserStatus @default(ACTIVE)
  pinCode     String?    @map("pin_code")
  
  // Organization
  hodId       String?    @map("hod_id")
  hod         User?      @relation("UserHod", fields: [hodId], references: [id])
  subordinates User[]    @relation("UserHod")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  posts     Post[]

  @@map("users")
}

enum UserStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
}

model Post {
  id        String   @id @default(uuid())
  title     String
  content   String?
  published Boolean  @default(false)
  authorId  String
  author    User     @relation(fields: [authorId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([authorId])
  @@map("posts")
}

enum Role {
  USER
  ADMIN
}

// Master Data: Location
model Province {
  id        Int      @id
  code      String   @unique
  name_th   String
  name_en   String
  createdAt DateTime @default(now()) @map("created_at")
  
  suppliers Supplier[]
  districts District[]

  @@map("provinces")
}

model District {
  id          Int      @id
  code        String   @unique
  name_th     String
  name_en     String
  provinceId  Int      @map("province_id")
  province    Province @relation(fields: [provinceId], references: [id])
  
  createdAt DateTime @default(now()) @map("created_at")

  suppliers    Supplier[]
  subdistricts Subdistrict[]

  @@map("districts")
}



model Subdistrict {
  id         Int      @id
  code       String   @unique
  name_th    String
  name_en    String
  zip_code   String?
  createdAt  DateTime @default(now()) @map("created_at")
  districtId Int      @map("district_id")
  district   District @relation(fields: [districtId], references: [id])
  
  suppliers Supplier[]

  @@map("subdistricts")
}

// Master Data: Rubber Type
model RubberType {
  id          String   @id @default(uuid())
  code        String   @unique
  name        String
  description String?
  category    String?
  is_active   Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@map("rubber_types")
}

// Mobile App: Supplier
model Supplier {
  id             String   @id @default(uuid())
  code           String   @unique
  name           String   @map("display_name")
  taxId          String?  @map("tax_id")
  address        String?
  phone          String?
  email          String?

  
  provinceId    Int?         @map("province_id")
  province      Province?    @relation(fields: [provinceId], references: [id])
  districtId    Int?         @map("district_id")
  district      District?    @relation(fields: [districtId], references: [id])
  subdistrictId Int?         @map("subdistrict_id")
  subdistrict   Subdistrict? @relation(fields: [subdistrictId], references: [id])
  
  status           String    @default("ACTIVE") @map("status") // Was is_active boolean, switching to String status for consistency with Users if desired, or keep boolean? 
  // User plan said "status String". I will map `status` to `is_active` logic or just add `status` field. 
  // Existing has `is_active Boolean`. I will replace/update to `status String` to match my plan, or simpler: keep `is_active` and map in DTO. 
  // Let's stick to the plan: `status String`. I'll comment out old `is_active` or remove it.
  
  notes            String?
  rubberTypeCodes String[]  @default([]) @map("rubber_type_codes")
  
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
  
  // Extra fields from SQL export matching
  firstName String? @map("first_name")
  lastName  String? @map("last_name")
  title      String?
  avatar     String?
  zipCode    String?   @map("zip_code")
  
  // Business Details
  certificateNumber    String?   @map("certificate_number")
  certificateExpire    DateTime? @map("certificate_expire")
  score               Float?    @default(0)
  eudrQuotaUsed       Float?    @map("eudr_quota_used")
  eudrQuotaCurrent    Float?    @map("eudr_quota_current")

  @@map("suppliers")
}
